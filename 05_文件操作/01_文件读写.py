#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
============================================================================
æ¨¡å—åç§°ï¼šæ–‡ä»¶è¯»å†™
å­¦ä¹ ç›®æ ‡ï¼šæŒæ¡ Python æ–‡ä»¶è¯»å†™çš„åŸºæœ¬æ–¹æ³•
PyCharm æŠ€å·§ï¼šå­¦ä¹ ä½¿ç”¨æ–‡ä»¶æ¨¡æ¿
============================================================================
"""

# ============================================================================
# ç¬¬ä¸€éƒ¨åˆ†ï¼šæ–‡ä»¶åŸºæœ¬æ“ä½œ
# ============================================================================
"""
ã€æ¦‚å¿µè®²è§£ã€‘
Python ä½¿ç”¨ open() å‡½æ•°æ‰“å¼€æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶å¯¹è±¡ã€‚
æ¨èä½¿ç”¨ with è¯­å¥ï¼Œè‡ªåŠ¨ç®¡ç†æ–‡ä»¶å…³é—­ã€‚
"""

# ----------------------------------------------------------------------------
# æ‰“å¼€æ–‡ä»¶
# ----------------------------------------------------------------------------

"""
æ–‡ä»¶æ‰“å¼€æ¨¡å¼ï¼š
- 'r': åªè¯»ï¼ˆé»˜è®¤ï¼‰
- 'w': å†™å…¥ï¼ˆè¦†ç›–ï¼‰
- 'x': æ’ä»–åˆ›å»ºï¼ˆæ–‡ä»¶å­˜åœ¨åˆ™æŠ¥é”™ï¼‰
- 'a': è¿½åŠ 
- 'b': äºŒè¿›åˆ¶æ¨¡å¼
- 't': æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- '+': è¯»å†™æ¨¡å¼

å¸¸ç”¨ç»„åˆï¼š
- 'r': è¯»å–æ–‡æœ¬
- 'w': å†™å…¥æ–‡æœ¬
- 'a': è¿½åŠ æ–‡æœ¬
- 'rb': è¯»å–äºŒè¿›åˆ¶
- 'wb': å†™å…¥äºŒè¿›åˆ¶
"""

# ----------------------------------------------------------------------------
# è¯»å–æ–‡ä»¶
# ----------------------------------------------------------------------------

# åˆ›å»ºç¤ºä¾‹æ–‡ä»¶
with open("example.txt", "w", encoding="utf-8") as f:
    f.write("ç¬¬ä¸€è¡Œ\nç¬¬äºŒè¡Œ\nç¬¬ä¸‰è¡Œ\n")

# æ–¹å¼1ï¼šè¯»å–å…¨éƒ¨å†…å®¹
with open("example.txt", "r", encoding="utf-8") as f:
    content = f.read()
    print(f"å…¨éƒ¨å†…å®¹:\n{content}")

# æ–¹å¼2ï¼šé€è¡Œè¯»å–
print("é€è¡Œè¯»å–:")
with open("example.txt", "r", encoding="utf-8") as f:
    for line in f:
        print(f"  {line.strip()}")

# æ–¹å¼3ï¼šè¯»å–æ‰€æœ‰è¡Œä¸ºåˆ—è¡¨
with open("example.txt", "r", encoding="utf-8") as f:
    lines = f.readlines()
    print(f"è¡Œåˆ—è¡¨: {lines}")

# æ–¹å¼4ï¼šè¯»å–æŒ‡å®šå­—ç¬¦æ•°
with open("example.txt", "r", encoding="utf-8") as f:
    first_chars = f.read(5)
    print(f"å‰5ä¸ªå­—ç¬¦: {first_chars}")

# ----------------------------------------------------------------------------
# å†™å…¥æ–‡ä»¶
# ----------------------------------------------------------------------------

# è¦†ç›–å†™å…¥
with open("output.txt", "w", encoding="utf-8") as f:
    f.write("Hello, Python!\n")
    f.write("æ–‡ä»¶å†™å…¥ç¤ºä¾‹\n")

# è¿½åŠ å†™å…¥
with open("output.txt", "a", encoding="utf-8") as f:
    f.write("è¿½åŠ çš„å†…å®¹\n")

# å†™å…¥å¤šè¡Œ
lines = ["ç¬¬ä¸€è¡Œ\n", "ç¬¬äºŒè¡Œ\n", "ç¬¬ä¸‰è¡Œ\n"]
with open("multi_lines.txt", "w", encoding="utf-8") as f:
    f.writelines(lines)

# ----------------------------------------------------------------------------
# æ–‡ä»¶æŒ‡é’ˆ
# ----------------------------------------------------------------------------

with open("example.txt", "r", encoding="utf-8") as f:
    print(f"åˆå§‹ä½ç½®: {f.tell()}")
    
    content = f.read(5)
    print(f"è¯»å–åä½ç½®: {f.tell()}")
    
    # ç§»åŠ¨æŒ‡é’ˆ
    f.seek(0)
    print(f"é‡ç½®åä½ç½®: {f.tell()}")
    
    content = f.read()
    print(f"ä»å¤´è¯»å–: {content}")

# ============================================================================
# ç¬¬äºŒéƒ¨åˆ†ï¼šwith è¯­å¥
# ============================================================================
"""
ã€æ¦‚å¿µè®²è§£ã€‘
with è¯­å¥è‡ªåŠ¨ç®¡ç†èµ„æºï¼Œç¡®ä¿æ–‡ä»¶æ­£ç¡®å…³é—­ã€‚
å³ä½¿å‘ç”Ÿå¼‚å¸¸ï¼Œæ–‡ä»¶ä¹Ÿä¼šè¢«æ­£ç¡®å…³é—­ã€‚
"""

# ä¼ ç»Ÿæ–¹å¼ï¼ˆä¸æ¨èï¼‰
try:
    f = open("example.txt", "r", encoding="utf-8")
    content = f.read()
finally:
    f.close()

# with è¯­å¥ï¼ˆæ¨èï¼‰
with open("example.txt", "r", encoding="utf-8") as f:
    content = f.read()

# åŒæ—¶æ‰“å¼€å¤šä¸ªæ–‡ä»¶
with open("example.txt", "r", encoding="utf-8") as src, \
     open("copy.txt", "w", encoding="utf-8") as dst:
    dst.write(src.read())

print("æ–‡ä»¶å¤åˆ¶å®Œæˆ")

# ============================================================================
# ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ–‡ä»¶å±æ€§å’Œæ“ä½œ
# ============================================================================

import os
from pathlib import Path

# ----------------------------------------------------------------------------
# ä½¿ç”¨ os æ¨¡å—
# ----------------------------------------------------------------------------

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
print(f"æ–‡ä»¶å­˜åœ¨: {os.path.exists('example.txt')}")
print(f"æ˜¯æ–‡ä»¶: {os.path.isfile('example.txt')}")
print(f"æ˜¯ç›®å½•: {os.path.isdir('.')}")

# è·å–æ–‡ä»¶ä¿¡æ¯
if os.path.exists('example.txt'):
    print(f"æ–‡ä»¶å¤§å°: {os.path.getsize('example.txt')} å­—èŠ‚")
    print(f"ä¿®æ”¹æ—¶é—´: {os.path.getmtime('example.txt')}")

# é‡å‘½å
# os.rename("old.txt", "new.txt")

# åˆ é™¤æ–‡ä»¶
# os.remove("file.txt")

# ----------------------------------------------------------------------------
# ä½¿ç”¨ pathlib æ¨¡å—ï¼ˆæ¨èï¼‰
# ----------------------------------------------------------------------------

# åˆ›å»º Path å¯¹è±¡
path = Path("example.txt")

print(f"å­˜åœ¨: {path.exists()}")
print(f"æ˜¯æ–‡ä»¶: {path.is_file()}")
print(f"æ–‡ä»¶å: {path.name}")
print(f"æ‰©å±•å: {path.suffix}")
print(f"çˆ¶ç›®å½•: {path.parent}")
print(f"ç»å¯¹è·¯å¾„: {path.absolute()}")

# è¯»å†™æ–‡ä»¶
content = path.read_text(encoding="utf-8")
path.write_text("æ–°å†…å®¹\n", encoding="utf-8")

# åˆ›å»ºç›®å½•
# Path("new_dir").mkdir(exist_ok=True)

# éå†ç›®å½•
# for item in Path(".").iterdir():
#     print(item)

# ============================================================================
# ç¬¬å››éƒ¨åˆ†ï¼šæ–‡ä»¶ç¼–ç 
# ============================================================================

# æŒ‡å®šç¼–ç 
with open("chinese.txt", "w", encoding="utf-8") as f:
    f.write("ä¸­æ–‡å†…å®¹æµ‹è¯•")

# è¯»å–æ—¶ä½¿ç”¨ç›¸åŒç¼–ç 
with open("chinese.txt", "r", encoding="utf-8") as f:
    print(f"ä¸­æ–‡å†…å®¹: {f.read()}")

# å¤„ç†ç¼–ç é”™è¯¯
with open("example.txt", "r", encoding="utf-8", errors="ignore") as f:
    content = f.read()

# ============================================================================
# ç¬¬äº”éƒ¨åˆ†ï¼šå®ç”¨ç¤ºä¾‹
# ============================================================================

# ----------------------------------------------------------------------------
# ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯
# ----------------------------------------------------------------------------

def file_stats(filepath):
    """ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯"""
    with open(filepath, "r", encoding="utf-8") as f:
        content = f.read()
    
    return {
        "å­—ç¬¦æ•°": len(content),
        "å•è¯æ•°": len(content.split()),
        "è¡Œæ•°": len(content.splitlines()),
        "å­—èŠ‚æ•°": len(content.encode("utf-8"))
    }

stats = file_stats("example.txt")
print(f"æ–‡ä»¶ç»Ÿè®¡: {stats}")

# ----------------------------------------------------------------------------
# æŒ‰è¡Œå¤„ç†å¤§æ–‡ä»¶
# ----------------------------------------------------------------------------

def process_large_file(filepath):
    """å¤„ç†å¤§æ–‡ä»¶ï¼ˆé€è¡Œè¯»å–ï¼Œä¸å ç”¨å¤§é‡å†…å­˜ï¼‰"""
    line_count = 0
    with open(filepath, "r", encoding="utf-8") as f:
        for line in f:
            line_count += 1
            # å¤„ç†æ¯ä¸€è¡Œ
            # process(line)
    return line_count

# ----------------------------------------------------------------------------
# æ–‡ä»¶æœç´¢
# ----------------------------------------------------------------------------

def search_in_file(filepath, keyword):
    """åœ¨æ–‡ä»¶ä¸­æœç´¢å…³é”®è¯"""
    results = []
    with open(filepath, "r", encoding="utf-8") as f:
        for line_num, line in enumerate(f, 1):
            if keyword in line:
                results.append((line_num, line.strip()))
    return results

results = search_in_file("example.txt", "è¡Œ")
print(f"æœç´¢ç»“æœ: {results}")

# ============================================================================
# æ¸…ç†æµ‹è¯•æ–‡ä»¶
# ============================================================================

import os
for f in ["example.txt", "output.txt", "multi_lines.txt", "copy.txt", "chinese.txt"]:
    if os.path.exists(f):
        os.remove(f)
print("\næµ‹è¯•æ–‡ä»¶å·²æ¸…ç†")

# ============================================================================
# æœ¬èŠ‚å°ç»“
# ============================================================================
"""
âœ… æŒæ¡çš„çŸ¥è¯†ç‚¹ï¼š
1. open() å‡½æ•°å’Œæ–‡ä»¶æ¨¡å¼
2. è¯»å–æ–‡ä»¶çš„å¤šç§æ–¹å¼
3. å†™å…¥æ–‡ä»¶
4. with è¯­å¥è‡ªåŠ¨ç®¡ç†èµ„æº
5. os å’Œ pathlib æ¨¡å—
6. æ–‡ä»¶ç¼–ç å¤„ç†

ğŸ”§ PyCharm æŠ€å·§ï¼š
1. Ctrl+Alt+S æ‰“å¼€è®¾ç½®
2. Editor â†’ File and Code Templates
3. åˆ›å»ºè‡ªå®šä¹‰æ–‡ä»¶æ¨¡æ¿

â¡ï¸ ä¸‹ä¸€èŠ‚ï¼šJSONå¤„ç†
"""

if __name__ == "__main__":
    print("\n" + "=" * 60)
    print("æ–‡ä»¶è¯»å†™æ¨¡å—å­¦ä¹ å®Œæˆï¼")
    print("=" * 60)
