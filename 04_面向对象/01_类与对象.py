#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
============================================================================
æ¨¡å—åç§°ï¼šç±»ä¸å¯¹è±¡
å­¦ä¹ ç›®æ ‡ï¼šç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µï¼ŒæŒæ¡ç±»çš„å®šä¹‰å’Œå¯¹è±¡çš„åˆ›å»º
PyCharm æŠ€å·§ï¼šå­¦ä¹ ä½¿ç”¨ Structure é¢æ¿æŸ¥çœ‹ç±»ç»“æ„
============================================================================
"""

# ============================================================================
# ç¬¬ä¸€éƒ¨åˆ†ï¼šé¢å‘å¯¹è±¡åŸºç¡€
# ============================================================================
"""
ã€æ¦‚å¿µè®²è§£ã€‘
é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒä½¿ç”¨"å¯¹è±¡"æ¥è®¾è®¡è½¯ä»¶ã€‚
å¯¹è±¡åŒ…å«æ•°æ®ï¼ˆå±æ€§ï¼‰å’Œä»£ç ï¼ˆæ–¹æ³•ï¼‰ã€‚

OOP çš„ä¸‰å¤§ç‰¹æ€§ï¼š
1. å°è£…ï¼šå°†æ•°æ®å’Œæ–¹æ³•åŒ…è£…åœ¨ä¸€èµ·
2. ç»§æ‰¿ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•
3. å¤šæ€ï¼šåŒä¸€æ–¹æ³•åœ¨ä¸åŒå¯¹è±¡ä¸­æœ‰ä¸åŒå®ç°
"""

# ----------------------------------------------------------------------------
# å®šä¹‰ç±»
# ----------------------------------------------------------------------------

class Person:
    """äººå‘˜ç±»"""
    
    # ç±»å±æ€§ï¼ˆæ‰€æœ‰å®ä¾‹å…±äº«ï¼‰
    species = "äººç±»"
    
    # æ„é€ æ–¹æ³•
    def __init__(self, name, age):
        """åˆå§‹åŒ–æ–¹æ³•"""
        # å®ä¾‹å±æ€§
        self.name = name
        self.age = age
    
    # å®ä¾‹æ–¹æ³•
    def introduce(self):
        """è‡ªæˆ‘ä»‹ç»"""
        return f"æˆ‘å«{self.name}ï¼Œä»Šå¹´{self.age}å²"
    
    def celebrate_birthday(self):
        """è¿‡ç”Ÿæ—¥"""
        self.age += 1
        return f"ç”Ÿæ—¥å¿«ä¹ï¼ç°åœ¨æˆ‘{self.age}å²äº†"

# åˆ›å»ºå¯¹è±¡ï¼ˆå®ä¾‹åŒ–ï¼‰
person1 = Person("å¼ ä¸‰", 25)
person2 = Person("æå››", 30)

# è®¿é—®å±æ€§
print(f"å§“å: {person1.name}")
print(f"å¹´é¾„: {person1.age}")
print(f"ç‰©ç§: {person1.species}")  # ç±»å±æ€§

# è°ƒç”¨æ–¹æ³•
print(person1.introduce())
print(person1.celebrate_birthday())

# ã€PyCharm æŠ€å·§ã€‘
# æŒ‰ Alt+7 æ‰“å¼€ Structure é¢æ¿ï¼Œå¯ä»¥æŸ¥çœ‹ç±»çš„ç»“æ„
# åŒ…æ‹¬å±æ€§ã€æ–¹æ³•å’Œç»§æ‰¿å…³ç³»

# ============================================================================
# ç¬¬äºŒéƒ¨åˆ†ï¼šå±æ€§å’Œæ–¹æ³•
# ============================================================================

# ----------------------------------------------------------------------------
# å®ä¾‹å±æ€§ vs ç±»å±æ€§
# ----------------------------------------------------------------------------

class Student:
    """å­¦ç”Ÿç±»"""
    
    # ç±»å±æ€§
    school = "æ¸…åå¤§å­¦"
    count = 0  # ç»Ÿè®¡å­¦ç”Ÿæ•°é‡
    
    def __init__(self, name, student_id):
        # å®ä¾‹å±æ€§
        self.name = name
        self.student_id = student_id
        Student.count += 1

# åˆ›å»ºå­¦ç”Ÿ
s1 = Student("å¼ ä¸‰", "2024001")
s2 = Student("æå››", "2024002")

print(f"å­¦ç”Ÿæ•°é‡: {Student.count}")
print(f"å­¦æ ¡: {s1.school}")

# ä¿®æ”¹ç±»å±æ€§ï¼ˆå½±å“æ‰€æœ‰å®ä¾‹ï¼‰
Student.school = "åŒ—äº¬å¤§å­¦"
print(f"ä¿®æ”¹å: {s1.school}, {s2.school}")

# ä¿®æ”¹å®ä¾‹å±æ€§ï¼ˆåªå½±å“å½“å‰å®ä¾‹ï¼‰
s1.school = "å¤æ—¦å¤§å­¦"  # åˆ›å»ºæ–°çš„å®ä¾‹å±æ€§
print(f"s1å­¦æ ¡: {s1.school}")  # å¤æ—¦å¤§å­¦
print(f"s2å­¦æ ¡: {s2.school}")  # åŒ—äº¬å¤§å­¦
print(f"ç±»å±æ€§: {Student.school}")  # åŒ—äº¬å¤§å­¦

# ----------------------------------------------------------------------------
# å®ä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ã€é™æ€æ–¹æ³•
# ----------------------------------------------------------------------------

class Counter:
    """è®¡æ•°å™¨ç±»"""
    
    total = 0  # ç±»å±æ€§
    
    def __init__(self):
        Counter.total += 1
        self.count = 0
    
    # å®ä¾‹æ–¹æ³•ï¼ˆå¯ä»¥è®¿é—®å®ä¾‹å’Œç±»ï¼‰
    def increment(self):
        """å¢åŠ è®¡æ•°"""
        self.count += 1
        return self.count
    
    # ç±»æ–¹æ³•ï¼ˆåªèƒ½è®¿é—®ç±»å±æ€§ï¼‰
    @classmethod
    def get_total(cls):
        """è·å–æ€»æ•°"""
        return cls.total
    
    # é™æ€æ–¹æ³•ï¼ˆä¸èƒ½è®¿é—®å®ä¾‹æˆ–ç±»å±æ€§ï¼‰
    @staticmethod
    def description():
        """æè¿°"""
        return "è¿™æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ç±»"

# ä½¿ç”¨
c1 = Counter()
c2 = Counter()

print(f"å®ä¾‹è®¡æ•°: {c1.increment()}, {c1.increment()}")
print(f"æ€»æ•°: {Counter.get_total()}")
print(f"æè¿°: {Counter.description()}")

# ============================================================================
# ç¬¬ä¸‰éƒ¨åˆ†ï¼šç»§æ‰¿
# ============================================================================

# ----------------------------------------------------------------------------
# å•ç»§æ‰¿
# ----------------------------------------------------------------------------

class Animal:
    """åŠ¨ç‰©åŸºç±»"""
    
    def __init__(self, name):
        self.name = name
    
    def speak(self):
        """å‘å£°"""
        return "å‘å‡ºå£°éŸ³"
    
    def info(self):
        return f"æˆ‘æ˜¯{self.name}"

class Dog(Animal):
    """ç‹—ç±»ï¼Œç»§æ‰¿è‡ª Animal"""
    
    def __init__(self, name, breed):
        # è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•
        super().__init__(name)
        self.breed = breed
    
    # é‡å†™çˆ¶ç±»æ–¹æ³•
    def speak(self):
        return "æ±ªæ±ªæ±ª"
    
    # æ–°å¢æ–¹æ³•
    def fetch(self):
        return f"{self.name}å»æ¡çƒ"

class Cat(Animal):
    """çŒ«ç±»ï¼Œç»§æ‰¿è‡ª Animal"""
    
    def speak(self):
        return "å–µå–µå–µ"

# ä½¿ç”¨
dog = Dog("æ—ºè´¢", "é‡‘æ¯›")
cat = Cat("å’ªå’ª")

print(dog.info())      # ç»§æ‰¿çš„æ–¹æ³•
print(dog.speak())     # é‡å†™çš„æ–¹æ³•
print(dog.fetch())     # æ–°å¢çš„æ–¹æ³•

print(cat.speak())

# æ£€æŸ¥ç»§æ‰¿å…³ç³»
print(f"Dog æ˜¯ Animal çš„å­ç±»: {issubclass(Dog, Animal)}")
print(f"dog æ˜¯ Dog çš„å®ä¾‹: {isinstance(dog, Dog)}")

# ----------------------------------------------------------------------------
# å¤šç»§æ‰¿
# ----------------------------------------------------------------------------

class Flyable:
    """å¯é£è¡Œçš„"""
    
    def fly(self):
        return "æ­£åœ¨é£è¡Œ"

class Swimmable:
    """å¯æ¸¸æ³³çš„"""
    
    def swim(self):
        return "æ­£åœ¨æ¸¸æ³³"

class Duck(Animal, Flyable, Swimmable):
    """é¸­å­ç±»ï¼Œå¤šç»§æ‰¿"""
    
    def speak(self):
        return "å˜å˜å˜"

duck = Duck("å”è€é¸­")
print(duck.speak())
print(duck.fly())
print(duck.swim())

# æ–¹æ³•è§£æé¡ºåºï¼ˆMROï¼‰
print(f"MRO: {Duck.__mro__}")

# ============================================================================
# ç¬¬å››éƒ¨åˆ†ï¼šå¤šæ€
# ============================================================================

# ----------------------------------------------------------------------------
# å¤šæ€ç¤ºä¾‹
# ----------------------------------------------------------------------------

def make_sound(animal):
    """è®©åŠ¨ç‰©å‘å£°"""
    print(f"{animal.name}: {animal.speak()}")

# ä¸åŒçš„åŠ¨ç‰©æœ‰ä¸åŒçš„å«å£°
animals = [Dog("æ—ºè´¢", "é‡‘æ¯›"), Cat("å’ªå’ª"), Duck("å”è€é¸­")]

for animal in animals:
    make_sound(animal)

# ã€è¯´æ˜ã€‘
# å¤šæ€å…è®¸æˆ‘ä»¬ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£å¤„ç†ä¸åŒç±»å‹çš„å¯¹è±¡
# æ¯ä¸ªå¯¹è±¡æ ¹æ®è‡ªå·±çš„å®ç°æ¥å“åº”ç›¸åŒçš„æ–¹æ³•è°ƒç”¨

# ============================================================================
# ç¬¬äº”éƒ¨åˆ†ï¼šå°è£…ä¸è®¿é—®æ§åˆ¶
# ============================================================================

class BankAccount:
    """é“¶è¡Œè´¦æˆ·ç±»"""
    
    def __init__(self, owner, balance):
        self.owner = owner           # å…¬æœ‰å±æ€§
        self._balance = balance      # å—ä¿æŠ¤å±æ€§ï¼ˆçº¦å®šï¼‰
        self.__secret = "å¯†ç "        # ç§æœ‰å±æ€§ï¼ˆåç§°ä¿®é¥°ï¼‰
    
    def deposit(self, amount):
        """å­˜æ¬¾"""
        if amount > 0:
            self._balance += amount
            return True
        return False
    
    def withdraw(self, amount):
        """å–æ¬¾"""
        if 0 < amount <= self._balance:
            self._balance -= amount
            return True
        return False
    
    def get_balance(self):
        """è·å–ä½™é¢"""
        return self._balance
    
    # property è£…é¥°å™¨å®ç°åªè¯»å±æ€§
    @property
    def balance(self):
        """ä½™é¢å±æ€§"""
        return self._balance

# ä½¿ç”¨
account = BankAccount("å¼ ä¸‰", 1000)

# å…¬æœ‰å±æ€§å¯è®¿é—®
print(f"æˆ·ä¸»: {account.owner}")

# å—ä¿æŠ¤å±æ€§ï¼ˆçº¦å®šä¸ç›´æ¥è®¿é—®ï¼‰
print(f"ä½™é¢: {account._balance}")  # å¯ä»¥è®¿é—®ï¼Œä½†ä¸æ¨è

# ç§æœ‰å±æ€§
# print(account.__secret)  # AttributeError
print(account._BankAccount__secret)  # åç§°ä¿®é¥°åå¯è®¿é—®

# ä½¿ç”¨æ–¹æ³•è®¿é—®
account.deposit(500)
print(f"å­˜æ¬¾åä½™é¢: {account.get_balance()}")

# ä½¿ç”¨ property
print(f"property ä½™é¢: {account.balance}")
# account.balance = 100  # ä¸èƒ½è®¾ç½®

# ============================================================================
# ç¬¬å…­éƒ¨åˆ†ï¼šå¸¸ç”¨é­”æ³•æ–¹æ³•
# ============================================================================

class Point:
    """ç‚¹ç±»"""
    
    def __init__(self, x, y):
        self.x = x
        self.y = y
    
    def __str__(self):
        """å­—ç¬¦ä¸²è¡¨ç¤º"""
        return f"Point({self.x}, {self.y})"
    
    def __repr__(self):
        """æ­£å¼å­—ç¬¦ä¸²è¡¨ç¤º"""
        return f"Point({self.x}, {self.y})"
    
    def __eq__(self, other):
        """ç›¸ç­‰æ¯”è¾ƒ"""
        return self.x == other.x and self.y == other.y
    
    def __add__(self, other):
        """åŠ æ³•è¿ç®—"""
        return Point(self.x + other.x, self.y + other.y)
    
    def __len__(self):
        """é•¿åº¦"""
        return int((self.x ** 2 + self.y ** 2) ** 0.5)
    
    def __getitem__(self, index):
        """ç´¢å¼•è®¿é—®"""
        if index == 0:
            return self.x
        elif index == 1:
            return self.y
        raise IndexError("Point index out of range")

# ä½¿ç”¨
p1 = Point(3, 4)
p2 = Point(1, 2)

print(f"å­—ç¬¦ä¸²: {p1}")  # __str__
print(f"ç›¸ç­‰: {p1 == p2}")  # __eq__
print(f"åŠ æ³•: {p1 + p2}")  # __add__
print(f"é•¿åº¦: {len(p1)}")  # __len__
print(f"ç´¢å¼•: {p1[0]}, {p1[1]}")  # __getitem__

# ============================================================================
# ç»ƒä¹ é¢˜
# ============================================================================
"""
ã€ç»ƒä¹ 1ã€‘å®šä¹‰ç±»
1. åˆ›å»ºä¸€ä¸ª Rectangle ç±»ï¼Œæœ‰é•¿ã€å®½å±æ€§å’Œè®¡ç®—é¢ç§¯ã€å‘¨é•¿çš„æ–¹æ³•
2. åˆ›å»ºä¸€ä¸ª Circle ç±»ï¼Œå®ç°ç±»ä¼¼åŠŸèƒ½
3. æ¯”è¾ƒä¸¤ä¸ªçŸ©å½¢çš„é¢ç§¯å¤§å°

ã€ç»ƒä¹ 2ã€‘ç»§æ‰¿
1. åˆ›å»º Shape åŸºç±»
2. åˆ›å»º Rectangle å’Œ Circle å­ç±»
3. å®ç°å¤šæ€ï¼šè®¡ç®—ä¸åŒå½¢çŠ¶çš„é¢ç§¯

ã€ç»ƒä¹ 3ã€‘é­”æ³•æ–¹æ³•
1. ä¸º Rectangle ç±»å®ç° __eq__ æ–¹æ³•
2. å®ç° __lt__ æ–¹æ³•æ¯”è¾ƒé¢ç§¯
3. å®ç° __str__ å’Œ __repr__ æ–¹æ³•
"""

# ============================================================================
# æœ¬èŠ‚å°ç»“
# ============================================================================
"""
âœ… æŒæ¡çš„çŸ¥è¯†ç‚¹ï¼š
1. ç±»çš„å®šä¹‰å’Œå¯¹è±¡çš„åˆ›å»º
2. å®ä¾‹å±æ€§å’Œç±»å±æ€§
3. å®ä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ã€é™æ€æ–¹æ³•
4. ç»§æ‰¿ï¼ˆå•ç»§æ‰¿ã€å¤šç»§æ‰¿ï¼‰
5. å¤šæ€
6. å°è£…å’Œè®¿é—®æ§åˆ¶
7. å¸¸ç”¨é­”æ³•æ–¹æ³•

ğŸ”§ PyCharm æŠ€å·§ï¼š
1. Alt+7 Structure é¢æ¿
2. Ctrl+H æŸ¥çœ‹ç»§æ‰¿å…³ç³»
3. Ctrl+O é‡å†™æ–¹æ³•
4. Alt+Insert ç”Ÿæˆä»£ç 

â¡ï¸ ä¸‹ä¸€èŠ‚ï¼šç»§æ‰¿ä¸å¤šæ€
"""

if __name__ == "__main__":
    print("\n" + "=" * 60)
    print("ç±»ä¸å¯¹è±¡æ¨¡å—å­¦ä¹ å®Œæˆï¼")
    print("=" * 60)
